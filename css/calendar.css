/* ─────────────────────────────────────────────────────────
   calendar.css
   잔디 캘린더 그리드 · 색상 · 툴팁 스타일

   그리드 구조:
   .calendar-wrap
     .calendar-header        ← 타이틀 + 통계
     .calendar-months        ← 월 레이블 (grid)
     .calendar-grid          ← 셀 그리드 (7행 × 53열)
       .calendar-cell        ← 날짜별 셀 (grass-0 ~ grass-3)
     .calendar-legend        ← 색상 범례
     .calendar-tooltip       ← 터치 시 툴팁
───────────────────────────────────────────────────────── */

/* ── 캘린더 래퍼 ──────────────────────────────────────── */
.calendar-wrap {
  background: var(--clr-bg-card);
  border: 1px solid var(--clr-border);
  border-radius: var(--radius-lg);
  padding: var(--space-lg);
  position: relative;
  overflow: hidden;
}

/* 배경 장식 */
.calendar-wrap::before {
  content: '';
  position: absolute;
  top: -40px;
  right: -40px;
  width: 180px;
  height: 180px;
  background: radial-gradient(circle, rgba(232,130,154,.08) 0%, transparent 70%);
  pointer-events: none;
}

/* ── 캘린더 헤더 ──────────────────────────────────────── */
.calendar-header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  margin-bottom: var(--space-lg);
  gap: var(--space-md);
}

.calendar-title {
  font-size: 1rem;
  font-weight: 700;
  color: var(--clr-ink);
}

/* 통계 뱃지 */
.calendar-stats {
  display: flex;
  gap: var(--space-sm);
  flex-wrap: wrap;
  justify-content: flex-end;
}

.stat-badge {
  background: var(--clr-bg);
  border: 1px solid var(--clr-border);
  border-radius: 20px;
  padding: 4px 12px;
  font-size: .75rem;
  color: var(--clr-ink-sub);
  white-space: nowrap;
}

.stat-badge strong {
  font-weight: 700;
  color: var(--clr-ink);
}

/* ── 스크롤 래퍼 (가로 스크롤) ───────────────────────── */
.calendar-scroll {
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
  padding-bottom: var(--space-sm);
  /* 스크롤바 숨기기 */
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.calendar-scroll::-webkit-scrollbar {
  display: none;
}

/* ── 월 레이블 ────────────────────────────────────────── */
#calendar-months {
  display: grid;
  grid-template-rows: 1fr;
  /* 열 수는 JS에서 동적으로 설정 (약 53열) */
  grid-auto-flow: column;
  grid-auto-columns: var(--cell-size, 13px);
  gap: var(--cell-gap, 3px);
  margin-bottom: 4px;
  min-width: max-content;
  padding-left: 24px; /* 요일 레이블 너비만큼 오프셋 */
}

.month-label {
  font-size: .65rem;
  color: var(--clr-ink-faint);
  font-weight: 500;
  letter-spacing: .02em;
  white-space: nowrap;
}

/* ── 캘린더 내부 레이아웃 (요일 + 그리드) ────────────── */
.calendar-inner {
  display: flex;
  gap: var(--cell-gap, 3px);
  min-width: max-content;
}

/* 요일 레이블 */
.calendar-weekdays {
  display: grid;
  grid-template-rows: repeat(7, var(--cell-size, 13px));
  gap: var(--cell-gap, 3px);
  padding-top: 1px;
}

.weekday-label {
  font-size: .6rem;
  color: var(--clr-ink-faint);
  display: flex;
  align-items: center;
  width: 20px;
  line-height: 1;
}

/* ── 잔디 그리드 ──────────────────────────────────────── */
#calendar-grid {
  display: grid;
  grid-template-rows: repeat(7, var(--cell-size, 13px));
  grid-auto-flow: column;
  grid-auto-columns: var(--cell-size, 13px);
  gap: var(--cell-gap, 3px);
  min-width: max-content;
}

/* ── 셀 크기 반응형 ───────────────────────────────────── */
:root {
  --cell-size: 13px;
  --cell-gap:  3px;
}

@media (max-width: 380px) {
  :root {
    --cell-size: 11px;
    --cell-gap:  2px;
  }
}

/* ── 잔디 셀 ──────────────────────────────────────────── */
.calendar-cell {
  width:  var(--cell-size);
  height: var(--cell-size);
  border-radius: 2px;
  cursor: pointer;
  transition: transform 120ms ease, opacity 120ms ease;
  position: relative;
}

.calendar-cell:hover {
  transform: scale(1.3);
  z-index: 10;
}

.calendar-cell:active {
  transform: scale(1.1);
}

/* ── 잔디 색상 (0단계: 빈 칸) ────────────────────────── */
.grass-0 {
  background: var(--grass-0);
}

/* ── 잔디 색상 (1단계: 연한 초록, 1-19개) ────────────── */
.grass-1 {
  background: var(--grass-1);
}

/* ── 잔디 색상 (2단계: 중간 초록, 20-29개) ───────────── */
.grass-2 {
  background: var(--grass-2);
}

/* ── 잔디 색상 (3단계: 진한 초록, 30개 이상) ─────────── */
.grass-3 {
  background: var(--grass-3);
}

/* 오늘 날짜 강조 */
.calendar-cell.today {
  outline: 2px solid var(--clr-sakura);
  outline-offset: 1px;
}

/* ── 범례 ─────────────────────────────────────────────── */
#calendar-legend {
  display: flex;
  align-items: center;
  gap: var(--space-xs);
  margin-top: var(--space-md);
  flex-wrap: wrap;
}

.legend-label {
  font-size: .7rem;
  color: var(--clr-ink-faint);
}

.legend-cell {
  width: 12px;
  height: 12px;
  border-radius: 2px;
}

.legend-detail {
  font-size: .68rem;
  color: var(--clr-ink-faint);
  margin-left: var(--space-xs);
}

/* ── 툴팁 ─────────────────────────────────────────────── */
#calendar-tooltip {
  position: absolute;
  transform: translate(-50%, -100%);
  margin-top: -8px;
  background: var(--clr-ink);
  color: #fff;
  border-radius: var(--radius-sm);
  padding: var(--space-sm) var(--space-md);
  font-size: .78rem;
  line-height: 1.6;
  white-space: nowrap;
  pointer-events: none;
  z-index: 300;
  box-shadow: 0 4px 16px rgba(28,26,23,.25);

  /* 말풍선 꼬리 */
  &::after {
    content: '';
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%);
    border: 6px solid transparent;
    border-top-color: var(--clr-ink);
  }
}

.tooltip-date {
  display: block;
  font-weight: 700;
  font-size: .8rem;
  margin-bottom: 2px;
}

.tooltip-count {
  display: block;
  color: var(--clr-sakura);
  font-weight: 600;
}

.tooltip-category {
  display: block;
  color: rgba(255,255,255,.65);
  font-size: .72rem;
}

/* ── 캘린더 진입 애니메이션 ───────────────────────────── */
@keyframes cellFadeIn {
  from { opacity: 0; transform: scale(.6); }
  to   { opacity: 1; transform: scale(1); }
}

/* 셀 스태거 애니메이션 (JS에서 animation-delay 부여 가능) */
.calendar-cell {
  animation: cellFadeIn 200ms cubic-bezier(.4, 0, .2, 1) both;
}

/* 성능을 위해 셀 수가 많으므로 will-change 최소화 */
.calendar-cell:hover {
  will-change: transform;
}
